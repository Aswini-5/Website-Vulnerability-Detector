# Website-Vulnerability-Detector
import streamlit as st
import requests
from bs4 import BeautifulSoup
from transformers import T5ForConditionalGeneration, T5Tokenizer
import sentencepiece

# Load pre-trained T5 model and tokenizer for vulnerability response generation
tokenizer = T5Tokenizer.from_pretrained("t5-small")
model = T5ForConditionalGeneration.from_pretrained("t5-small")

# Function to generate AI-based response
def generate_response(attack):
    input_text = f"Explain the reason and provide a solution for the {attack}."
    input_ids = tokenizer.encode(input_text, return_tensors="pt")
    output = model.generate(input_ids, max_length=150, num_return_sequences=1, early_stopping=True)
    response = tokenizer.decode(output[0], skip_special_tokens=True)
    return response

# Function to scan website for potential attacks
def scan_website(url):
    attacks = []

    try:
        response = requests.get(url)
        soup = BeautifulSoup(response.text, 'html.parser')

        # Check for potential attack vectors
        if '=' in response.url:
            attacks.append(("Potential SQL Injection Attack", "SQL Injection may occur due to unvalidated user inputs in URL parameters."))
        if soup.find_all('script'):
            attacks.append(("Potential Cross-Site Scripting (XSS) Attack", "Cross-Site Scripting (XSS) vulnerabilities may arise from unescaped or improperly sanitized user inputs reflected in the HTML response."))
        if soup.find_all('form'):
            attacks.append(("Potential CSRF Attack", "Cross-Site Request Forgery (CSRF) vulnerabilities may occur if forms lack CSRF tokens to prevent unauthorized form submissions."))

        # Add more attack detection logic here...

    except requests.exceptions.RequestException as e:
        attacks.append(("Connection Error", f"Connection to {url} failed. Please check the website URL and try again."))

    return attacks

# Streamlit app
def main():
    st.title("Website Attack Scanner")
    url = st.text_input("Enter the URL of the website to scan:")
    if st.button("Scan"):
        if not url:
            st.warning("Please enter a valid URL.")
        else:
            attacks = scan_website(url)
            if attacks:
                st.write("### Potential Attacks Detected:")
                for attack, reason in attacks:
                    st.write("- " + attack)
                    st.write("   - *Reason*: " + reason)
                    st.write("   - *Solution*: " + generate_response(attack))
            else:
                st.success("No potential attacks detected.")

if _name_ == "_main_":
    main()
